From 9e3d5d81693e45208d1d1bfc7325a47d0caab26a Mon Sep 17 00:00:00 2001
From: "i.Dark_Templar" <darktemplar@dark-templar-archives.net>
Date: Fri, 12 Jun 2020 21:44:05 +0300
Subject: [PATCH] Fix warnings

---
 dbusaddons/fcitxqtconnection.cpp      | 10 ++++++++--
 platforminputcontext/fcitxwatcher.cpp | 10 ++++++++--
 2 files changed, 16 insertions(+), 4 deletions(-)

diff --git a/dbusaddons/fcitxqtconnection.cpp b/dbusaddons/fcitxqtconnection.cpp
index 4770c4c..817d911 100644
--- a/dbusaddons/fcitxqtconnection.cpp
+++ b/dbusaddons/fcitxqtconnection.cpp
@@ -119,8 +119,14 @@ void FcitxQtConnectionPrivate::initialize() {
 
 void FcitxQtConnectionPrivate::finalize() {
     m_serviceWatcher->removeWatchedService(m_serviceName);
-    m_watcher->removePaths(m_watcher->files());
-    m_watcher->removePaths(m_watcher->directories());
+    if (!m_watcher->files().isEmpty())
+    {
+        m_watcher->removePaths(m_watcher->files());
+    }
+    if (!m_watcher->directories().isEmpty())
+    {
+        m_watcher->removePaths(m_watcher->directories());
+    }
     disconnect(m_watcher, &QFileSystemWatcher::fileChanged, this,
                &FcitxQtConnectionPrivate::socketFileChanged);
     disconnect(m_watcher, &QFileSystemWatcher::directoryChanged, this,
diff --git a/platforminputcontext/fcitxwatcher.cpp b/platforminputcontext/fcitxwatcher.cpp
index 1a2b4ba..9bdfa68 100644
--- a/platforminputcontext/fcitxwatcher.cpp
+++ b/platforminputcontext/fcitxwatcher.cpp
@@ -256,8 +256,14 @@ void FcitxWatcher::watchSocketFile() {
 }
 
 void FcitxWatcher::unwatchSocketFile() {
-    m_fsWatcher->removePaths(m_fsWatcher->files());
-    m_fsWatcher->removePaths(m_fsWatcher->directories());
+    if (!m_fsWatcher->files().isEmpty())
+    {
+        m_fsWatcher->removePaths(m_fsWatcher->files());
+    }
+    if (!m_fsWatcher->directories().isEmpty())
+    {
+        m_fsWatcher->removePaths(m_fsWatcher->directories());
+    }
     m_fsWatcher->disconnect(SIGNAL(fileChanged(QString)));
     m_fsWatcher->disconnect(SIGNAL(directoryChanged(QString)));
 }
-- 
2.26.2

