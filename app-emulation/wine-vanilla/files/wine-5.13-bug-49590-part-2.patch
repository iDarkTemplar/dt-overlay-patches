Related to https://bugs.winehq.org/show_bug.cgi?id=49590

Signed-off-by: Paul Gofman <pgofman at codeweavers.com>
---
 dlls/iphlpapi/ipstats.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/dlls/iphlpapi/ipstats.c b/dlls/iphlpapi/ipstats.c
index 03e53abfb44..d8c2ce029b4 100644
--- a/dlls/iphlpapi/ipstats.c
+++ b/dlls/iphlpapi/ipstats.c
@@ -1912,6 +1912,7 @@ static struct pid_map *get_pid_map( unsigned int *num_entries )
             HeapFree( GetProcessHeap(), 0, buffer );
             return NULL;
         }
+        buffer = new_buffer;
     }
 
     if (!(map = HeapAlloc( GetProcessHeap(), 0, map_count * sizeof(*map) )))
-- 
2.26.2
